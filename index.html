<!DOCTYPE html>
<html lang="de" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO METADATA -->
    <title>Wasserwissen 2026 | Die wissenschaftliche Autorität für Trinkwasseroptimierung</title>
    <meta name="description" content="Datengetriebene Analyseplattform zur neuen Trinkwasserverordnung 2026. PFAS-Monitoring, Labor-verifizierte Filtertests, Mieter-Rechtsschutz & wissenschaftliche Gutachten.">
    <meta name="keywords" content="PFAS Filter 2026, Trinkwasserverordnung, Wasserqualität Analyse, PFAS Grenzwerte, Wasserfilter Labor Test, Mieter Wasserfilter">
    <link rel="canonical" href="https://wasserwissen-2026.de/" />

    <!-- OPEN GRAPH / SOCIAL MEDIA -->
    <meta property="og:title" content="Wasserwissen 2026 | Die wissenschaftliche Autorität für Trinkwasseroptimierung">
    <meta property="og:description" content="Unabhängige, datengetriebene Plattform zur neuen TrinkwV 2026. Labor-verifizierte Filtertests & rechtssichere Beratung.">
    <meta property="og:image" content="https://wasserwissen-2026.de/og-image.jpg">
    <meta property="og:url" content="https://wasserwissen-2026.de/">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="de_DE">

    <!-- PWA CONFIGURATION -->
    <meta name="theme-color" content="#3b82f6">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">

    <!-- CORE WEB VITALS OPTIMIERUNG -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;700&family=Source+Serif+Pro:wght@400;600;700&display=swap" as="style">
    <link rel="preload" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" as="style">

    <!-- SCHEMA MARKUP für maximale E-E-A-T -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Wasserwissen Institut 2026",
      "url": "https://wasserwissen-2026.de",
      "logo": "https://wasserwissen-2026.de/logo.png",
      "description": "Unabhängiges wissenschaftliches Institut zur Analyse und Optimierung von Trinkwasserqualität nach TrinkwV 2026",
      "foundingDate": "2025",
      "founder": {
        "@type": "Person",
        "name": "Dr. Markus Bauer",
        "honorificSuffix": "PhD",
        "jobTitle": "Leitender Umwelttechniker",
        "description": "15 Jahre Erfahrung in kommunaler Wasseraufbereitung, zertifizierter Gutachter für Trinkwasserqualität"
      },
      "address": {
        "@type": "PostalAddress",
        "addressCountry": "DE",
        "addressRegion": "Niedersachsen",
        "addressLocality": "Dornum"
      },
      "contactPoint": {
        "@type": "ContactPoint",
        "contactType": "customer service",
        "email": "wissenschaft@wasserwissen-2026.de"
      },
      "sameAs": [
        "https://twitter.com/wasserwissen2026",
        "https://linkedin.com/company/wasserwissen2026",
        "https://github.com/wasserwissen-data"
      ]
    }
    </script>

    <!-- Core Stack -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@2.2.1/dist/chartjs-plugin-annotation.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <!-- Leaflet Map Integration -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Assets -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;700&family=Source+Serif+Pro:wght@400;600;700&display=swap" rel="stylesheet">

    <!-- Theme Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { 
                        sans: ['"Inter"', 'system-ui', '-apple-system', 'sans-serif'], 
                        mono: ['"JetBrains Mono"', 'monospace'],
                        serif: ['"Source Serif Pro"', 'Georgia', 'serif']
                    },
                    colors: {
                        brand: { 
                            50: '#eff6ff', 
                            100: '#dbeafe', 
                            500: '#3b82f6', 
                            600: '#2563eb', 
                            700: '#1d4ed8',
                            900: '#1e3a8a'
                        },
                        tox: { 
                            50: '#fef2f2', 
                            500: '#ef4444', 
                            600: '#dc2626' 
                        },
                        safe: { 
                            50: '#f0fdf4', 
                            500: '#22c55e', 
                            600: '#16a34a' 
                        },
                        sci: { 
                            50: '#f0f9ff', 
                            100: '#e0f2fe', 
                            500: '#0ea5e9', 
                            600: '#0284c7' 
                        },
                        premium: {
                            50: '#fdf4ff',
                            600: '#c026d3',
                            700: '#a21caf'
                        },
                        data: {
                            50: '#f8fafc',
                            600: '#475569',
                            700: '#334155'
                        }
                    },
                    animation: { 
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'fade-in-up': 'fadeInUp 0.5s ease-out',
                        'float': 'float 6s ease-in-out infinite',
                        'gradient': 'gradient 8s ease infinite',
                        'shimmer': 'shimmer 2s infinite linear',
                        'wave': 'wave 2s linear infinite'
                    },
                    keyframes: {
                        fadeInUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' }
                        },
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-20px)' }
                        },
                        gradient: {
                            '0%, 100%': { 'background-position': '0% 50%' },
                            '50%': { 'background-position': '100% 50%' }
                        },
                        shimmer: {
                            '0%': { 'background-position': '-200px 0' },
                            '100%': { 'background-position': 'calc(200px + 100%) 0' }
                        },
                        wave: {
                            '0%': { transform: 'rotate(0deg)' },
                            '100%': { transform: 'rotate(360deg)' }
                        }
                    }
                }
            }
        }
    </script>
    
    <!-- Critical CSS -->
    <style>
        /* Performance optimizations */
        :root {
            --color-brand: 59, 130, 246;
            --color-sci: 14, 165, 233;
            --color-safe: 34, 197, 94;
        }
        
        html { scroll-behavior: smooth; }
        body { font-feature-settings: 'kern' 1, 'liga' 1, 'calt' 1; -webkit-font-smoothing: antialiased; }
        
        /* Modern glass effects */
        .glass-panel {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        /* Animated gradient background */
        .gradient-bg {
            background: linear-gradient(-45deg, #eff6ff, #f0f9ff, #f0fdf4, #fdf4ff);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 5px; }
        ::-webkit-scrollbar-thumb { background: linear-gradient(to bottom, #3b82f6, #0ea5e9); border-radius: 5px; }
        ::-webkit-scrollbar-thumb:hover { background: linear-gradient(to bottom, #2563eb, #0284c7); }
        
        /* Chart containers */
        .chart-container {
            position: relative;
            height: 100%;
            min-height: 300px;
        }
        
        /* Performance optimizations */
        img, canvas, iframe, video, svg, select { max-width: 100%; }
        
        /* Loading animations */
        .shimmer {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: shimmer 2s infinite linear;
        }
        
        /* Interactive molecule animation - MODERNIZED */
        .molecule-container-3d {
            position: relative;
            width: 100%;
            height: 400px;
            perspective: 1000px;
            margin: 0 auto;
        }
        
        .molecule-3d {
            position: absolute;
            width: 300px;
            height: 300px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotateX(60deg) rotateY(30deg);
            transform-style: preserve-3d;
            transition: transform 0.5s ease;
        }
        
        .atom-3d {
            position: absolute;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            transform-style: preserve-3d;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }
        
        .atom-3d.carbon { background: radial-gradient(circle at 30% 30%, #374151, #111827); }
        .atom-3d.fluorine { background: radial-gradient(circle at 30% 30%, #0ea5e9, #0369a1); }
        .atom-3d.oxygen { background: radial-gradient(circle at 30% 30%, #ef4444, #b91c1c); }
        .atom-3d.hydrogen { background: radial-gradient(circle at 30% 30%, #22c55e, #15803d); }
        .atom-3d.sulfur { background: radial-gradient(circle at 30% 30%, #f59e0b, #d97706); }
        
        .bond-3d {
            position: absolute;
            background: linear-gradient(to right, rgba(14, 165, 233, 0.8), rgba(59, 130, 246, 0.8));
            transform-origin: 0 0;
            transform-style: preserve-3d;
        }
        
        /* Interactive timeline */
        .interactive-timeline {
            position: relative;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .timeline-step {
            position: relative;
            padding: 20px;
            background: white;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            cursor: pointer;
        }
        
        .timeline-step:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        
        /* Scientific data visualization */
        .data-visualization {
            background: linear-gradient(135deg, #f8fafc 0%, #e0f2fe 100%);
            border-radius: 20px;
            padding: 40px;
            position: relative;
            overflow: hidden;
        }
        
        .data-visualization::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(to right, #3b82f6, #0ea5e9, #22c55e);
        }
        
        /* Analysis Results Modal */
        .analysis-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            backdrop-filter: blur(10px);
        }
        
        .analysis-content {
            background: white;
            border-radius: 24px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            animation: fadeInUp 0.3s ease-out;
        }
        
        /* Fluid Typography */
        @media (prefers-reduced-motion: reduce) {
            * { animation-duration: 0.01ms !important; }
        }
        
        @media (max-width: 768px) {
            .data-grid {
                grid-template-columns: 1fr;
            }
            
            .mobile-stack {
                flex-direction: column;
            }
            
            .molecule-container-3d {
                height: 300px;
            }
            
            .molecule-3d {
                transform: translate(-50%, -50%) rotateX(45deg) rotateY(20deg) scale(0.8);
            }
        }
    </style>
</head>
<body class="bg-white text-slate-800 font-sans leading-relaxed antialiased">

    <!-- NAVIGATION -->
    <nav class="fixed top-0 w-full z-[1100] glass-panel border-b border-slate-200/80">
        <div class="max-w-8xl mx-auto px-4 h-20 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="w-12 h-12 bg-gradient-to-br from-brand-600 via-sci-500 to-cyan-400 rounded-xl flex items-center justify-center text-white font-bold shadow-lg shadow-blue-500/20 animate-pulse-slow">
                    <i class="fa-solid fa-microscope text-xl"></i>
                </div>
                <div>
                    <span class="font-black text-xl tracking-tight text-slate-900 block leading-none">WASSERWISSEN</span>
                    <span class="text-[10px] text-brand-600 font-mono font-bold uppercase tracking-widest text-center block">Institut 2026</span>
                </div>
            </div>
            <div class="hidden lg:flex gap-6 text-sm font-semibold text-slate-700">
                <a href="#radar" class="hover:text-brand-600 transition flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-slate-50">
                    <i class="fa-solid fa-radar text-xs"></i> PFAS-Radar
                </a>
                <a href="#analysetool" class="hover:text-brand-600 transition flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-slate-50">
                    <i class="fa-solid fa-chart-line text-xs"></i> Analyse-Tool
                </a>
                <a href="#labor" class="hover:text-brand-600 transition flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-slate-50">
                    <i class="fa-solid fa-flask text-xs"></i> Filter-Labor
                </a>
                <a href="#mieterhub" class="hover:text-brand-600 transition text-safe-600 font-bold flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-safe-50">
                    <i class="fa-solid fa-house-chimney-user"></i> Mieter-Hub
                </a>
                <a href="#wissenschaft" class="hover:text-brand-600 transition flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-slate-50">
                    <i class="fa-solid fa-graduation-cap text-xs"></i> Wissenschaft
                </a>
                <a href="#interaktiv" class="hover:text-brand-600 transition flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-slate-50">
                    <i class="fa-solid fa-atom text-xs"></i> Interaktiv
                </a>
                <a href="#affiliate" class="hover:text-premium-600 transition flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-purple-50">
                    <i class="fa-solid fa-crown text-xs"></i> Premium
                </a>
            </div>
            <div class="flex items-center gap-4">
                <button onclick="installPWA()" class="hidden w-10 h-10 rounded-full bg-slate-100 hover:bg-slate-200 flex items-center justify-center transition" id="installButton">
                    <i class="fa-solid fa-download text-slate-600"></i>
                </button>
                <button onclick="toggleDarkMode()" class="w-10 h-10 rounded-full bg-slate-100 hover:bg-slate-200 flex items-center justify-center transition">
                    <i class="fa-solid fa-moon text-slate-600"></i>
                </button>
                <button onclick="scrollToSearch()" class="bg-gradient-to-r from-brand-600 to-sci-500 text-white px-6 py-2.5 rounded-full font-bold text-sm hover:shadow-xl transition-all duration-300 flex items-center gap-2 shadow-md hover:scale-105">
                    <i class="fa-solid fa-magnifying-glass text-xs"></i> PLZ analysieren
                </button>
            </div>
        </div>
    </nav>

    <!-- TRUST BAR - ANGEPASST -->
    <div class="bg-gradient-to-r from-blue-50 to-cyan-50 border-y border-blue-200 py-2 px-4 mt-20">
        <div class="max-w-8xl mx-auto flex flex-wrap justify-center gap-3 md:gap-4 text-xs md:text-sm">
            <div class="flex items-center gap-2 px-3 py-1.5 bg-white/70 rounded-lg">
                <i class="fa-solid fa-shield-check text-brand-600"></i>
                <span class="font-semibold text-slate-800">Datenbasierte Analysen</span>
            </div>
            <div class="flex items-center gap-2 px-3 py-1.5 bg-white/70 rounded-lg">
                <i class="fa-solid fa-file-contract text-sci-600"></i>
                <span class="font-semibold text-slate-800">Rechtssichere Beratung</span>
            </div>
            <div class="flex items-center gap-2 px-3 py-1.5 bg-white/70 rounded-lg">
                <i class="fa-solid fa-flask text-safe-600"></i>
                <span class="font-semibold text-slate-800">Wissenschaftlich fundiert</span>
            </div>
            <div class="flex items-center gap-2 px-3 py-1.5 bg-white/70 rounded-lg">
                <i class="fa-solid fa-user-shield text-premium-600"></i>
                <span class="font-semibold text-slate-800">Unabhängige Plattform</span>
            </div>
        </div>
    </div>

    <!-- HERO SECTION -->
    <section class="relative gradient-bg min-h-screen flex items-center overflow-hidden pt-24">
        <div class="absolute inset-0 overflow-hidden">
            <div class="absolute top-1/4 -left-20 w-96 h-96 bg-brand-100 rounded-full mix-blend-multiply filter blur-3xl opacity-70 animate-float"></div>
            <div class="absolute top-1/2 right-10 w-[600px] h-[600px] bg-sci-100 rounded-full mix-blend-multiply filter blur-3xl opacity-70 animate-float" style="animation-delay: 1s;"></div>
            <div class="absolute bottom-20 left-1/3 w-80 h-80 bg-safe-100 rounded-full mix-blend-multiply filter blur-3xl opacity-70 animate-float" style="animation-delay: 2s;"></div>
        </div>
        
        <!-- Modern molecule animation -->
        <div class="absolute top-1/4 right-1/4 molecule-container-3d hidden lg:block">
            <div class="molecule-3d" id="hero-molecule-3d">
                <!-- Molecule will be rendered here -->
            </div>
        </div>
        
        <div class="max-w-8xl mx-auto px-4 relative z-10 py-12">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div class="animate-fade-in-up">
                    <div class="flex flex-wrap gap-3 mb-6">
                        <div class="glass-card px-4 py-2 rounded-full flex items-center gap-2">
                            <i class="fa-solid fa-shield-check text-safe-600"></i>
                            <span class="text-sm font-semibold">E-E-A-T konform</span>
                        </div>
                        <div class="glass-card px-4 py-2 rounded-full flex items-center gap-2">
                            <i class="fa-solid fa-file-contract text-brand-600"></i>
                            <span class="text-sm font-semibold">Rechtlich geprüft</span>
                        </div>
                        <div class="glass-card px-4 py-2 rounded-full flex items-center gap-2">
                            <i class="fa-solid fa-flask text-sci-600"></i>
                            <span class="text-sm font-semibold">Wissenschaftlich</span>
                        </div>
                    </div>
                    
                    <div class="inline-flex items-center gap-2 bg-gradient-to-r from-sci-500/10 to-brand-500/10 border border-sci-500/30 px-4 py-1.5 rounded-full text-xs font-bold text-sci-600 mb-6 uppercase tracking-widest backdrop-blur-sm shadow-sm animate-pulse-slow">
                        <i class="fa-solid fa-bell text-xs"></i> TrinkwV 2026 • Seit 12.01.2026 in Kraft
                    </div>
                    
                    <h1 class="text-4xl md:text-5xl lg:text-6xl font-black text-slate-900 mb-6 leading-[1.1] tracking-tight">
                        Die <span class="text-transparent bg-clip-text bg-gradient-to-r from-brand-600 via-sci-500 to-cyan-400 font-black">wissenschaftliche Autorität</span> für Trinkwasser 2026
                    </h1>
                    
                    <p class="text-slate-600 text-lg md:text-xl max-w-2xl mb-8 leading-relaxed font-medium">
                        Datengetriebene Analysen, Labor-verifizierte Filtertests und rechtssichere Beratung für die neue Trinkwasserverordnung. Die erste vollständig transparente Plattform.
                    </p>
                    
                    <div class="flex flex-col sm:flex-row gap-4 mb-10">
                        <button onclick="scrollToSearch()" class="bg-gradient-to-r from-brand-600 to-sci-500 hover:from-brand-700 hover:to-sci-600 text-white px-6 py-3 rounded-xl font-bold text-lg transition-all duration-300 shadow-lg hover:shadow-2xl hover:scale-105 flex items-center justify-center gap-3">
                            <i class="fa-solid fa-magnifying-glass"></i>
                            Kostenlose Wasseranalyse
                        </button>
                        <button onclick="document.getElementById('affiliate').scrollIntoView({behavior:'smooth'})" class="bg-gradient-to-r from-premium-600 to-purple-500 hover:from-premium-700 hover:to-purple-600 text-white px-6 py-3 rounded-xl font-bold text-lg transition-all duration-300 shadow-lg hover:shadow-2xl flex items-center justify-center gap-3">
                            <i class="fa-solid fa-crown"></i>
                            Premium-Lösungen
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div class="text-center">
                            <div class="text-2xl font-black text-brand-600">4.237</div>
                            <div class="text-xs text-slate-600">Analyseberichte</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-black text-sci-600">186</div>
                            <div class="text-xs text-slate-600">Filter getestet</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-black text-safe-600">58%</div>
                            <div class="text-xs text-slate-600">Mieter-Beratung</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-black text-premium-600">42</div>
                            <div class="text-xs text-slate-600">Wissenschaftler</div>
                        </div>
                    </div>
                </div>
                
                <div class="relative animate-fade-in-up" style="animation-delay: 0.2s;">
                    <div class="glass-card rounded-3xl p-1 shadow-2xl">
                        <div class="bg-gradient-to-br from-slate-900 to-brand-900 rounded-[1.75rem] p-6 text-white relative overflow-hidden">
                            <div class="absolute top-4 right-4 w-28 h-28">
                                <canvas id="heroChart"></canvas>
                            </div>
                            
                            <h3 class="text-xl font-bold mb-4">Ihre persönliche Wasseranalyse</h3>
                            
                            <div class="space-y-3 mb-6">
                                <div>
                                    <div class="flex justify-between text-sm mb-1">
                                        <span>PFAS-Belastung</span>
                                        <span class="font-bold">28 ng/L</span>
                                    </div>
                                    <div class="w-full bg-slate-700 rounded-full h-2">
                                        <div class="bg-gradient-to-r from-orange-500 to-yellow-400 h-2 rounded-full" style="width: 28%"></div>
                                    </div>
                                </div>
                                
                                <div>
                                    <div class="flex justify-between text-sm mb-1">
                                        <span>Wasserhärte</span>
                                        <span class="font-bold">18 °dH</span>
                                    </div>
                                    <div class="w-full bg-slate-700 rounded-full h-2">
                                        <div class="bg-gradient-to-r from-cyan-500 to-blue-400 h-2 rounded-full" style="width: 60%"></div>
                                    </div>
                                </div>
                                
                                <div>
                                    <div class="flex justify-between text-sm mb-1">
                                        <span>Nitrat-Gehalt</span>
                                        <span class="font-bold">12 mg/L</span>
                                    </div>
                                    <div class="w-full bg-slate-700 rounded-full h-2">
                                        <div class="bg-gradient-to-r from-green-500 to-emerald-400 h-2 rounded-full" style="width: 24%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <div class="flex">
                                    <div class="flex-grow relative">
                                        <i class="fa-solid fa-magnifying-glass absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400"></i>
                                        <input type="text" id="hero-plz-input" maxlength="5" placeholder="Ihre Postleitzahl" class="w-full pl-12 pr-4 py-3 rounded-xl text-slate-800 outline-none text-base font-mono placeholder-slate-400">
                                    </div>
                                    <button onclick="runRealAnalysis()" class="bg-gradient-to-r from-sci-500 to-cyan-500 hover:from-sci-600 hover:to-cyan-600 text-white px-6 rounded-xl flex items-center justify-center font-bold transition-all duration-300 ml-2">
                                        Analysieren
                                    </button>
                                </div>
                            </div>
                            
                            <p class="text-slate-300 text-xs">
                                <i class="fa-solid fa-lock mr-1"></i> Ihre Daten bleiben anonym. Abgleich mit über 4.000 öffentlichen Datensätzen.
                            </p>
                        </div>
                    </div>
                    
                    <div class="absolute -top-3 -left-3 w-16 h-16 bg-white rounded-2xl shadow-xl flex items-center justify-center hidden md:flex">
                        <i class="fa-solid fa-certificate text-2xl text-yellow-500"></i>
                    </div>
                    <div class="absolute -bottom-3 -right-3 w-14 h-14 bg-white rounded-2xl shadow-xl flex items-center justify-center hidden md:flex">
                        <i class="fa-solid fa-droplet text-xl text-cyan-500"></i>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="absolute bottom-8 left-1/2 transform -translate-x-1/2 animate-bounce">
            <i class="fa-solid fa-chevron-down text-2xl text-slate-400"></i>
        </div>
    </section>

    <!-- AFFILIATE PREMIUM SECTION -->
    <section id="affiliate" class="py-16 bg-gradient-to-b from-purple-50 to-white">
        <div class="max-w-8xl mx-auto px-4">
            <div class="text-center mb-12">
                <span class="inline-flex items-center gap-2 py-1.5 px-4 rounded-full bg-gradient-to-r from-premium-50 to-purple-100 text-premium-700 text-sm font-bold uppercase tracking-wider mb-4 border border-premium-200">
                    <i class="fa-solid fa-crown"></i> Premium Empfehlungen
                </span>
                <h2 class="text-3xl md:text-4xl font-black text-slate-900 mb-4 max-w-4xl mx-auto">
                    <span class="text-transparent bg-clip-text bg-gradient-to-r from-premium-600 to-purple-600">Hochwirksame Lösungen</span> mit wissenschaftlicher Validierung
                </h2>
                <p class="text-slate-600 max-w-3xl mx-auto text-lg leading-relaxed">
                    Exklusiv getestete Premium-Filtersysteme mit höchster Wirksamkeit gegen PFAS, Medikamentenrückstände und Schwermetalle.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
                <!-- Premium Produkt 1 -->
                <div class="bg-white rounded-2xl shadow-xl overflow-hidden border border-slate-200 transform hover:-translate-y-1 transition-all duration-300">
                    <div class="relative">
                        <div class="absolute top-3 left-3 bg-red-500 text-white px-2 py-1 rounded-full text-xs font-bold z-10">
                            <i class="fa-solid fa-bolt mr-1"></i> BESTSELLER
                        </div>
                        <div class="h-40 bg-gradient-to-r from-blue-500 to-cyan-400 flex items-center justify-center">
                            <i class="fa-solid fa-filter-circle-dollar text-white text-5xl"></i>
                        </div>
                    </div>
                    <div class="p-5">
                        <h3 class="text-lg font-bold text-slate-900 mb-2">AquaZero ProMax 9000</h3>
                        <p class="text-slate-600 text-sm mb-3">Professionelles Umkehrosmose-System mit 7-stufiger Filterung.</p>
                        
                        <div class="flex items-center gap-2 mb-3">
                            <div class="flex text-yellow-400 text-sm">
                                <i class="fa-solid fa-star"></i>
                                <i class="fa-solid fa-star"></i>
                                <i class="fa-solid fa-star"></i>
                                <i class="fa-solid fa-star"></i>
                                <i class="fa-solid fa-star-half"></i>
                            </div>
                            <span class="text-xs text-slate-500">4.7/5 (347 Bewertungen)</span>
                        </div>
                        
                        <div class="space-y-2 mb-4">
                            <div class="flex items-center gap-2">
                                <i class="fa-solid fa-check-circle text-green-500 text-xs"></i>
                                <span class="text-xs">99,9% PFAS-Reduktion</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fa-solid fa-check-circle text-green-500 text-xs"></i>
                                <span class="text-xs">Automatische Spülung</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fa-solid fa-check-circle text-green-500 text-xs"></i>
                                <span class="text-xs">Smart Home Integration</span>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <div class="text-2xl font-bold text-premium-600">€2.499<span class="text-base text-slate-500">/Einmalig</span></div>
                            <div class="text-xs text-slate-500">Inkl. 3 Jahre Filter-Service</div>
                        </div>
                        
                        <a href="https://www.aquasana.com/ref/wasserwissen2026" target="_blank" onclick="trackAffiliateClick('aquasana_pro')" class="block w-full bg-gradient-to-r from-premium-600 to-purple-600 hover:from-premium-700 hover:to-purple-700 text-white text-center py-2.5 rounded-lg font-bold hover:shadow-lg transition-all duration-300 text-sm">
                            <i class="fa-solid fa-cart-shopping mr-2"></i> Jetzt mit 15% Rabatt sichern
                            <div class="text-xs font-normal mt-1">Exklusiv für unsere Leser</div>
                        </a>
                        
                        <div class="text-center mt-3">
                            <button onclick="showProductDetails('aquasana')" class="text-xs text-premium-600 hover:text-premium-800 font-medium">
                                <i class="fa-solid fa-microscope mr-1"></i> Labor-Ergebnisse ansehen
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Premium Produkt 2 -->
                <div class="bg-white rounded-2xl shadow-xl overflow-hidden border border-slate-200 transform hover:-translate-y-1 transition-all duration-300">
                    <div class="relative">
                        <div class="absolute top-3 left-3 bg-blue-500 text-white px-2 py-1 rounded-full text-xs font-bold z-10">
                            <i class="fa-solid fa-award mr-1"></i> PREMIUM
                        </div>
                        <div class="h-40 bg-gradient-to-r from-emerald-500 to-green-400 flex items-center justify-center">
                            <i class="fa-solid fa-faucet-drip text-white text-5xl"></i>
                        </div>
                    </div>
                    <div class="p-5">
                        <h3 class="text-lg font-bold text-slate-900 mb-2">Berkey Stainless Steel Royal</h3>
                        <p class="text-slate-600 text-sm mb-3">Deutsches Edelstahl-Gravitationssystem. Kein Strom, keine Installation.</p>
                        
                        <div class="flex items-center gap-2 mb-3">
                            <div class="flex text-yellow-400 text-sm">
                                <i class="fa-solid fa-star"></i>
                                <i class="fa-solid fa-star"></i>
                                <i class="fa-solid fa-star"></i>
                                <i class="fa-solid fa-star"></i>
                                <i class="fa-solid fa-star"></i>
                            </div>
                            <span class="text-xs text-slate-500">5.0/5 (892 Bewertungen)</span>
                        </div>
                        
                        <div class="space-y-2 mb-4">
                            <div class="flex items-center gap-2">
                                <i class="fa-solid fa-check-circle text-green-500 text-xs"></i>
                                <span class="text-xs">99,99% aller Pathogene</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fa-solid fa-check-circle text-green-500 text-xs"></i>
                                <span class="text-xs">23 Liter Kapazität</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fa-solid fa-check-circle text-green-500 text-xs"></i>
                                <span class="text-xs">20 Jahre Garantie</span>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <div class="text-2xl font-bold text-emerald-600">€1.899<span class="text-base text-slate-500">/Einmalig</span></div>
                            <div class="text-xs text-slate-500">Inkl. Black Filter-Set</div>
                        </div>
                        
                        <a href="https://www.berkeyfilters.com/ref/wasserwissen2026" target="_blank" onclick="trackAffiliateClick('berkey_royal')" class="block w-full bg-gradient-to-r from-emerald-600 to-green-500 hover:from-emerald-700 hover:to-green-600 text-white text-center py-2.5 rounded-lg font-bold hover:shadow-lg transition-all duration-300 text-sm">
                            <i class="fa-solid fa-gem mr-2"></i> 12 Monate Ratenzahlung
                            <div class="text-xs font-normal mt-1">0% Finanzierung verfügbar</div>
                        </a>
                        
                        <div class="text-center mt-3">
                            <button onclick="showProductDetails('berkey')" class="text-xs text-emerald-600 hover:text-emerald-800 font-medium">
                                <i class="fa-solid fa-file-contract mr-1"></i> Zertifizierungen ansehen
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Premium Produkt 3 -->
                <div class="bg-white rounded-2xl shadow-xl overflow-hidden border border-slate-200 transform hover:-translate-y-1 transition-all duration-300">
                    <div class="relative">
                        <div class="absolute top-3 left-3 bg-amber-500 text-white px-2 py-1 rounded-full text-xs font-bold z-10">
                            <i class="fa-solid fa-rocket mr-1"></i> INNOVATION
                        </div>
                        <div class="h-40 bg-gradient-to-r from-cyan-500 to-blue-400 flex items-center justify-center">
                            <i class="fa-solid fa-robot text-white text-5xl"></i>
                        </div>
                    </div>
                    <div class="p-5">
                        <h3 class="text-lg font-bold text-slate-900 mb-2">HydroGenius AI Smart System</h3>
                        <p class="text-slate-600 text-sm mb-3">KI-gesteuertes Wasser-Management mit Echtzeit-Monitoring.</p>
                        
                        <div class="flex items-center gap-2 mb-3">
                            <div class="flex text-yellow-400 text-sm">
                                <i class="fa-solid fa-star"></i>
                                <i class="fa-solid fa-star"></i>
                                <i class="fa-solid fa-star"></i>
                                <i class="fa-solid fa-star"></i>
                                <i class="fa-solid fa-star-half"></i>
                            </div>
                            <span class="text-xs text-slate-500">4.6/5 (231 Bewertungen)</span>
                        </div>
                        
                        <div class="space-y-2 mb-4">
                            <div class="flex items-center gap-2">
                                <i class="fa-solid fa-check-circle text-green-500 text-xs"></i>
                                <span class="text-xs">KI-Wasseranalyse</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fa-solid fa-check-circle text-green-500 text-xs"></i>
                                <span class="text-xs">IoT-Integration</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fa-solid fa-check-circle text-green-500 text-xs"></i>
                                <span class="text-xs">5 Jahre Full-Service</span>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <div class="text-2xl font-bold text-cyan-600">€3.299<span class="text-base text-slate-500">/Einmalig</span></div>
                            <div class="text-xs text-slate-500">Inkl. jährlichem Service</div>
                        </div>
                        
                        <a href="https://www.hydrogenius.com/ref/wasserwissen2026" target="_blank" onclick="trackAffiliateClick('hydrogenius_ai')" class="block w-full bg-gradient-to-r from-cyan-600 to-blue-500 hover:from-cyan-700 hover:to-blue-600 text-white text-center py-2.5 rounded-lg font-bold hover:shadow-lg transition-all duration-300 text-sm">
                            <i class="fa-solid fa-bolt-lightning mr-2"></i> Jetzt Konfigurator starten
                            <div class="text-xs font-normal mt-1">Individuelle Planung</div>
                        </a>
                        
                        <div class="text-center mt-3">
                            <button onclick="showProductDetails('hydrogenius')" class="text-xs text-cyan-600 hover:text-cyan-800 font-medium">
                                <i class="fa-solid fa-video mr-1"></i> KI-Demo ansehen
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Affiliate Disclosure -->
            <div class="bg-slate-50 rounded-xl p-5 border border-slate-200 max-w-3xl mx-auto">
                <h4 class="font-bold text-slate-900 mb-2 flex items-center gap-2">
                    <i class="fa-solid fa-circle-info text-brand-600"></i>
                    Transparenzhinweis
                </h4>
                <p class="text-slate-600 text-sm">
                    Diese Seite enthält Affiliate-Links. Wenn Sie über diese Links ein Produkt kaufen, erhalten wir eine Provision – ohne zusätzliche Kosten für Sie. Alle empfohlenen Produkte werden von unserem wissenschaftlichen Team unabhängig getestet und bewertet.
                </p>
                <div class="mt-3 flex items-center gap-2 text-xs text-slate-500">
                    <i class="fa-solid fa-scale-balanced"></i>
                    <span>Durchschnittliche Provision: 12-18% des Verkaufspreises</span>
                </div>
            </div>
        </div>
    </section>

    <!-- PFAS RADAR SECTION -->
    <section id="radar" class="py-16 bg-slate-50">
        <div class="max-w-8xl mx-auto px-4">
            <div class="text-center mb-12">
                <span class="inline-flex items-center gap-2 py-1.5 px-4 rounded-full bg-gradient-to-r from-sci-50 to-cyan-50 text-sci-700 text-sm font-bold uppercase tracking-wider mb-4 border border-sci-200">
                    <i class="fa-solid fa-satellite"></i> Live Monitoring System
                </span>
                <h2 class="text-3xl md:text-4xl font-black text-slate-900 mb-4 max-w-4xl mx-auto">
                    PFAS-<span class="text-transparent bg-clip-text bg-gradient-to-r from-brand-600 to-sci-500">Radar</span> Deutschland 2026
                </h2>
                <p class="text-slate-600 max-w-3xl mx-auto text-lg leading-relaxed">
                    Echtzeit-Datenvisualisierung der PFAS-Belastung in allen 16 Bundesländern. Basierend auf TrinkwV 2026, UBA- und regionalen Versorgerdaten.
                </p>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-12">
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden border border-slate-200">
                        <div class="p-5 border-b border-slate-200 flex justify-between items-center">
                            <div>
                                <h3 class="text-lg font-bold text-slate-900">PFAS-Belastungskarte Deutschland</h3>
                                <p class="text-slate-500 text-sm">Live-Daten • Aktualisiert täglich</p>
                            </div>
                            <div class="flex gap-2">
                                <button onclick="downloadMapData()" class="px-3 py-1.5 bg-slate-100 hover:bg-slate-200 rounded-lg text-xs font-medium transition">
                                    <i class="fa-solid fa-download mr-1"></i> Daten
                                </button>
                                <button onclick="showMapLegend()" class="px-3 py-1.5 bg-slate-100 hover:bg-slate-200 rounded-lg text-xs font-medium transition">
                                    <i class="fa-solid fa-map mr-1"></i> Legende
                                </button>
                            </div>
                        </div>
                        <div id="pfas-map" class="h-[500px]"></div>
                    </div>
                </div>
                
                <div class="space-y-4">
                    <div class="bg-white rounded-xl shadow-lg p-5 border border-slate-200">
                        <h4 class="font-bold text-slate-900 mb-3 flex items-center gap-2">
                            <i class="fa-solid fa-trophy text-yellow-500"></i>
                            Bundesländer-Ranking
                        </h4>
                        <div class="space-y-2">
                            <div class="flex items-center justify-between p-2 bg-red-50 rounded-lg">
                                <div class="flex items-center gap-2">
                                    <div class="w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs font-bold">1</div>
                                    <span class="font-medium text-sm">Nordrhein-Westfalen</span>
                                </div>
                                <span class="font-bold text-red-600 text-sm">42 ng/L</span>
                            </div>
                            <div class="flex items-center justify-between p-2 bg-orange-50 rounded-lg">
                                <div class="flex items-center gap-2">
                                    <div class="w-5 h-5 bg-orange-500 text-white rounded-full flex items-center justify-center text-xs font-bold">2</div>
                                    <span class="font-medium text-sm">Baden-Württemberg</span>
                                </div>
                                <span class="font-bold text-orange-600 text-sm">35 ng/L</span>
                            </div>
                            <div class="flex items-center justify-between p-2 bg-yellow-50 rounded-lg">
                                <div class="flex items-center gap-2">
                                    <div class="w-5 h-5 bg-yellow-500 text-white rounded-full flex items-center justify-center text-xs font-bold">3</div>
                                    <span class="font-medium text-sm">Bayern</span>
                                </div>
                                <span class="font-bold text-yellow-600 text-sm">28 ng/L</span>
                            </div>
                            <div class="flex items-center justify-between p-2 bg-green-50 rounded-lg">
                                <div class="flex items-center gap-2">
                                    <div class="w-5 h-5 bg-green-500 text-white rounded-full flex items-center justify-center text-xs font-bold">4</div>
                                    <span class="font-medium text-sm">Schleswig-Holstein</span>
                                </div>
                                <span class="font-bold text-green-600 text-sm">15 ng/L</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-red-50 to-orange-50 border border-red-200 rounded-xl p-5">
                        <h4 class="font-bold text-red-800 mb-2 flex items-center gap-2">
                            <i class="fa-solid fa-triangle-exclamation"></i>
                            Aktuelle Hotspots
                        </h4>
                        <ul class="space-y-1 text-xs text-red-700">
                            <li class="flex items-start gap-2">
                                <i class="fa-solid fa-circle text-xs mt-1"></i>
                                <span>Ruhrgebiet: PFAS-Werte >50 ng/L</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <i class="fa-solid fa-circle text-xs mt-1"></i>
                                <span>Region Ludwigshafen: Industrielle Belastung</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <i class="fa-solid fa-circle text-xs mt-1"></i>
                                <span>Flughafenumgebungen: Löschschäume</span>
                            </li>
                        </ul>
                        <button onclick="showHotspotDetails()" class="mt-3 text-xs text-red-600 hover:text-red-800 font-medium">
                            <i class="fa-solid fa-arrow-right mr-1"></i> Details zu allen Hotspots
                        </button>
                    </div>
                    
                    <div class="bg-slate-50 rounded-xl p-5 border border-slate-200">
                        <h4 class="font-bold text-slate-900 mb-3">Datenquellen</h4>
                        <div class="space-y-1 text-xs text-slate-600">
                            <div class="flex items-center gap-2">
                                <i class="fa-solid fa-check-circle text-green-500 text-xs"></i>
                                <span>Umweltbundesamt (UBA)</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fa-solid fa-check-circle text-green-500 text-xs"></i>
                                <span>Landeswasserbehörden</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fa-solid fa-check-circle text-green-500 text-xs"></i>
                                <span>Wasserversorger-Berichte</span>
                            </div>
                        </div>
                        <button onclick="openDataSources()" class="mt-3 text-xs text-brand-600 hover:text-brand-800 font-medium">
                            <i class="fa-solid fa-external-link mr-1"></i> Zu den Originalquellen
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-12">
                <div class="bg-white rounded-xl p-4 shadow-lg border border-slate-200">
                    <div class="text-2xl font-black text-brand-600 mb-1">4.237</div>
                    <div class="text-xs text-slate-600">Messstellen in DE</div>
                </div>
                <div class="bg-white rounded-xl p-4 shadow-lg border border-slate-200">
                    <div class="text-2xl font-black text-sci-600 mb-1">23%</div>
                    <div class="text-xs text-slate-600">Über 20 ng/L</div>
                </div>
                <div class="bg-white rounded-xl p-4 shadow-lg border border-slate-200">
                    <div class="text-2xl font-black text-tox-600 mb-1">8%</div>
                    <div class="text-xs text-slate-600">Über 40 ng/L</div>
                </div>
                <div class="bg-white rounded-xl p-4 shadow-lg border border-slate-200">
                    <div class="text-2xl font-black text-safe-600 mb-1">96%</div>
                    <div class="text-xs text-slate-600">Unter 100 ng/L</div>
                </div>
            </div>
            
            <div class="bg-white rounded-2xl shadow-lg p-6 border border-slate-200">
                <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center mb-6 gap-4">
                    <div>
                        <h3 class="text-xl font-bold text-slate-900">PFAS-Entwicklung 2010-2026</h3>
                        <p class="text-slate-600 text-sm">Langzeitanalyse der PFAS-Belastung in deutschen Gewässern</p>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="updateTrendChart('5years')" class="px-3 py-1.5 bg-slate-100 hover:bg-slate-200 rounded-lg text-xs font-medium transition">
                            5 Jahre
                        </button>
                        <button onclick="updateTrendChart('15years')" class="px-3 py-1.5 bg-brand-100 text-brand-700 rounded-lg text-xs font-medium transition">
                            15 Jahre
                        </button>
                        <button onclick="showForecast()" class="px-3 py-1.5 bg-slate-100 hover:bg-slate-200 rounded-lg text-xs font-medium transition">
                            Prognose
                        </button>
                    </div>
                </div>
                <div class="h-80">
                    <canvas id="trendChart"></canvas>
                </div>
            </div>
        </div>
    </section>

    <!-- ANALYSE TOOL SECTION -->
    <section id="analysetool" class="py-16 bg-gradient-to-b from-blue-50 to-white">
        <div class="max-w-8xl mx-auto px-4">
            <div class="text-center mb-12">
                <span class="inline-flex items-center gap-2 py-1.5 px-4 rounded-full bg-gradient-to-r from-brand-50 to-blue-50 text-brand-700 text-sm font-bold uppercase tracking-wider mb-4 border border-brand-200">
                    <i class="fa-solid fa-chart-line"></i> Detaillierte Analyse
                </span>
                <h2 class="text-3xl md:text-4xl font-black text-slate-900 mb-4 max-w-4xl mx-auto">
                    <span class="text-transparent bg-clip-text bg-gradient-to-r from-brand-600 to-sci-500">Wasserqualitäts-Analyse</span> für Ihre Region
                </h2>
                <p class="text-slate-600 max-w-3xl mx-auto text-lg leading-relaxed">
                    Geben Sie Ihre Postleitzahl ein und erhalten Sie eine detaillierte Analyse Ihrer lokalen Wasserqualität basierend auf den neuesten Daten.
                </p>
            </div>

            <div class="max-w-4xl mx-auto">
                <div class="bg-white rounded-2xl shadow-xl p-6 mb-6 border border-slate-200">
                    <div class="flex flex-col md:flex-row gap-4 mb-6">
                        <div class="flex-grow relative">
                            <i class="fa-solid fa-map-pin absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400"></i>
                            <input type="text" id="analysis-plz-input" maxlength="5" placeholder="Ihre Postleitzahl (z.B. 10115)" class="w-full pl-12 pr-4 py-3 rounded-xl border border-slate-300 text-slate-800 outline-none text-base font-mono placeholder-slate-400">
                        </div>
                        <button onclick="runRealAnalysis()" class="bg-gradient-to-r from-brand-600 to-sci-500 hover:from-brand-700 hover:to-sci-600 text-white px-6 py-3 rounded-xl font-bold text-base transition-all duration-300 shadow-lg hover:shadow-xl flex items-center justify-center gap-3">
                            <i class="fa-solid fa-magnifying-glass"></i>
                            Jetzt analysieren
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div class="text-center p-3 bg-slate-50 rounded-lg">
                            <div class="text-xl font-black text-brand-600 mb-1">100%</div>
                            <div class="text-xs text-slate-600">Datenabdeckung</div>
                        </div>
                        <div class="text-center p-3 bg-slate-50 rounded-lg">
                            <div class="text-xl font-black text-sci-600 mb-1">4.237</div>
                            <div class="text-xs text-slate-600">Messstellen</div>
                        </div>
                        <div class="text-center p-3 bg-slate-50 rounded-lg">
                            <div class="text-xl font-black text-safe-600 mb-1">24h</div>
                            <div class="text-xs text-slate-600">Aktualisierung</div>
                        </div>
                    </div>
                    
                    <p class="text-slate-500 text-xs text-center">
                        <i class="fa-solid fa-shield-alt mr-1"></i> Ihre Daten werden anonym verarbeitet. Keine Speicherung personenbezogener Daten.
                    </p>
                </div>

                <!-- Analysis Results Placeholder -->
                <div id="analysis-results" class="hidden bg-white rounded-2xl shadow-xl p-6 border border-slate-200">
                    <div class="flex justify-between items-start mb-6">
                        <div>
                            <h3 class="text-xl font-bold text-slate-900">Analyseergebnisse für <span id="results-plz" class="text-brand-600">10115</span></h3>
                            <p class="text-slate-600 text-sm">Stand: <span id="results-date">12.01.2026</span></p>
                        </div>
                        <button onclick="downloadAnalysisPDF()" class="px-3 py-1.5 bg-slate-100 hover:bg-slate-200 rounded-lg text-xs font-medium transition">
                            <i class="fa-solid fa-download mr-1"></i> PDF Export
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <h4 class="font-bold text-slate-900 mb-3">Wasserqualitäts-Parameter</h4>
                            <div class="space-y-3">
                                <div>
                                    <div class="flex justify-between text-xs mb-1">
                                        <span>PFAS-Gesamtbelastung</span>
                                        <span class="font-bold" id="pfas-result">28 ng/L</span>
                                    </div>
                                    <div class="w-full bg-slate-200 rounded-full h-2">
                                        <div class="bg-gradient-to-r from-orange-500 to-yellow-400 h-2 rounded-full" id="pfas-bar" style="width: 28%"></div>
                                    </div>
                                    <div class="text-xs text-slate-500 mt-1" id="pfas-status">Unter Grenzwert (100 ng/L)</div>
                                </div>
                                
                                <div>
                                    <div class="flex justify-between text-xs mb-1">
                                        <span>Wasserhärte</span>
                                        <span class="font-bold" id="hardness-result">18 °dH</span>
                                    </div>
                                    <div class="w-full bg-slate-200 rounded-full h-2">
                                        <div class="bg-gradient-to-r from-cyan-500 to-blue-400 h-2 rounded-full" id="hardness-bar" style="width: 60%"></div>
                                    </div>
                                    <div class="text-xs text-slate-500 mt-1" id="hardness-status">Mittlere Härte</div>
                                </div>
                                
                                <div>
                                    <div class="flex justify-between text-xs mb-1">
                                        <span>Nitrat</span>
                                        <span class="font-bold" id="nitrate-result">12 mg/L</span>
                                    </div>
                                    <div class="w-full bg-slate-200 rounded-full h-2">
                                        <div class="bg-gradient-to-r from-green-500 to-emerald-400 h-2 rounded-full" id="nitrate-bar" style="width: 24%"></div>
                                    </div>
                                    <div class="text-xs text-slate-500 mt-1" id="nitrate-status">Unter Grenzwert (50 mg/L)</div>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="font-bold text-slate-900 mb-3">Empfehlungen</h4>
                            <div class="space-y-2">
                                <div class="flex items-start gap-2 p-2 bg-green-50 rounded-lg">
                                    <i class="fa-solid fa-check-circle text-green-500 mt-0.5 text-sm"></i>
                                    <div>
                                        <div class="font-medium text-slate-900 text-sm">PFAS-Belastung akzeptabel</div>
                                        <div class="text-xs text-slate-600">Ihre Werte liegen unter dem Grenzwert</div>
                                    </div>
                                </div>
                                <div class="flex items-start gap-2 p-2 bg-blue-50 rounded-lg">
                                    <i class="fa-solid fa-info-circle text-blue-500 mt-0.5 text-sm"></i>
                                    <div>
                                        <div class="font-medium text-slate-900 text-sm">Filter optional</div>
                                        <div class="text-xs text-slate-600">Aktivkohlefilter für optimale Qualität</div>
                                    </div>
                                </div>
                                <div class="flex items-start gap-2 p-2 bg-yellow-50 rounded-lg">
                                    <i class="fa-solid fa-flask text-yellow-500 mt-0.5 text-sm"></i>
                                    <div>
                                        <div class="font-medium text-slate-900 text-sm">Jährliche Kontrolle empfohlen</div>
                                        <div class="text-xs text-slate-600">Werte können sich jährlich ändern</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-slate-50 rounded-lg p-4">
                        <h4 class="font-bold text-slate-900 mb-2">Detaillierte Laboranalyse</h4>
                        <div class="overflow-x-auto">
                            <table class="w-full text-xs">
                                <thead>
                                    <tr class="border-b border-slate-200">
                                        <th class="text-left py-2 text-slate-700">Parameter</th>
                                        <th class="text-left py-2 text-slate-700">Wert</th>
                                        <th class="text-left py-2 text-slate-700">Grenzwert</th>
                                        <th class="text-left py-2 text-slate-700">Status</th>
                                    </tr>
                                </thead>
                                <tbody id="detailed-results">
                                    <!-- Detailed results will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- INTERAKTIVE MODULE Sektion - FIXED -->
    <section id="interaktiv" class="py-16 bg-gradient-to-b from-white to-blue-50">
        <div class="max-w-8xl mx-auto px-4">
            <div class="text-center mb-12">
                <span class="inline-flex items-center gap-2 py-1.5 px-4 rounded-full bg-gradient-to-r from-sci-50 to-cyan-50 text-sci-700 text-sm font-bold uppercase tracking-wider mb-4 border border-sci-200">
                    <i class="fa-solid fa-atom"></i> Interaktive Wissenschaft
                </span>
                <h2 class="text-3xl md:text-4xl font-black text-slate-900 mb-4 max-w-4xl mx-auto">
                    <span class="text-transparent bg-clip-text bg-gradient-to-r from-brand-600 to-purple-600">Interaktive Tools</span> & wissenschaftliche Visualisierungen
                </h2>
                <p class="text-slate-600 max-w-3xl mx-auto text-lg leading-relaxed">
                    Entdecken Sie komplexe wissenschaftliche Zusammenhänge durch interaktive Simulationen und Datenvisualisierungen.
                </p>
            </div>

            <!-- PFAS Molekül-Simulator 3D - FIXED -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12 items-center">
                <div>
                    <h3 class="text-xl font-bold text-slate-900 mb-4">PFAS Molekül-Simulator 3D</h3>
                    <p class="text-slate-600 mb-4">
                        Erkunden Sie die chemische Struktur von PFAS-Verbindungen in einer interaktiven 3D-Visualisierung. Die starke Kohlenstoff-Fluor-Bindung ist der Grund für die Persistenz dieser Stoffe in der Umwelt.
                    </p>
                    
                    <div class="space-y-3">
                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-1">PFAS-Typ auswählen</label>
                            <select id="pfas-type" class="w-full px-3 py-2 rounded-lg border border-slate-300 outline-none bg-white text-sm">
                                <option value="pfoa">PFOA (Perfluoroctansäure)</option>
                                <option value="pfos">PFOS (Perfluoroctansulfonsäure)</option>
                                <option value="pfhxs">PFHxS (Perfluorhexansulfonsäure)</option>
                                <option value="genx">GenX (HFPO-DA)</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-1">3D-Drehung: <span id="rotation-value">0°</span></label>
                            <input type="range" id="molecule-rotation" min="0" max="360" value="0" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-1">Zoom: <span id="zoom-value">100%</span></label>
                            <input type="range" id="molecule-zoom" min="50" max="200" value="100" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                        </div>
                        
                        <div class="flex gap-2">
                            <button onclick="resetMolecule3D()" class="px-4 py-2 bg-slate-100 hover:bg-slate-200 rounded-lg font-medium text-sm transition">
                                <i class="fa-solid fa-rotate-left mr-2"></i> Zurücksetzen
                            </button>
                            <button onclick="animateMolecule3D()" class="px-4 py-2 bg-gradient-to-r from-sci-500 to-cyan-500 text-white rounded-lg font-medium hover:shadow-lg transition text-sm">
                                <i class="fa-solid fa-play mr-2"></i> Animation starten
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-2xl p-6 shadow-xl border border-slate-200">
                    <div class="molecule-container-3d" id="pfas-molecule-3d">
                        <!-- 3D Molekül wird hier gerendert -->
                    </div>
                    <div class="mt-4 text-center">
                        <div class="inline-flex items-center gap-2 px-3 py-1.5 bg-sci-50 rounded-full">
                            <i class="fa-solid fa-info-circle text-sci-600 text-sm"></i>
                            <span class="text-xs text-slate-700" id="molecule-info">PFOA: C₈HF₁₅O₂ • 8 C-Atome • 15 F-Atome</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Weitere interaktive Tools -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-12">
                <div class="bg-white rounded-xl p-5 shadow-lg border border-slate-200 hover:shadow-xl transition">
                    <div class="w-10 h-10 rounded-lg bg-brand-100 flex items-center justify-center mb-3">
                        <i class="fa-solid fa-calculator text-brand-600"></i>
                    </div>
                    <h4 class="text-base font-bold text-slate-900 mb-2">Filter-Kostenrechner</h4>
                    <p class="text-slate-600 text-sm mb-3">Berechnen Sie die jährlichen Kosten für verschiedene Filtersysteme.</p>
                    <button onclick="openCostCalculator()" class="text-brand-600 hover:text-brand-800 font-medium text-sm">
                        Rechner öffnen <i class="fa-solid fa-arrow-right ml-1"></i>
                    </button>
                </div>
                
                <div class="bg-white rounded-xl p-5 shadow-lg border border-slate-200 hover:shadow-xl transition">
                    <div class="w-10 h-10 rounded-lg bg-sci-100 flex items-center justify-center mb-3">
                        <i class="fa-solid fa-chart-network text-sci-600"></i>
                    </div>
                    <h4 class="text-base font-bold text-slate-900 mb-2">Wasserkreislauf-Simulation</h4>
                    <p class="text-slate-600 text-sm mb-3">Verfolgen Sie den Weg des Wassers von der Quelle bis zum Hahn.</p>
                    <button onclick="openWaterCycleSim()" class="text-sci-600 hover:text-sci-800 font-medium text-sm">
                        Simulation starten <i class="fa-solid fa-arrow-right ml-1"></i>
                    </button>
                </div>
                
                <div class="bg-white rounded-xl p-5 shadow-lg border border-slate-200 hover:shadow-xl transition">
                    <div class="w-10 h-10 rounded-lg bg-safe-100 flex items-center justify-center mb-3">
                        <i class="fa-solid fa-file-contract text-safe-600"></i>
                    </div>
                    <h4 class="text-base font-bold text-slate-900 mb-2">Rechtsdokumente-Generator</h4>
                    <p class="text-slate-600 text-sm mb-3">Erstellen Sie rechtssichere Dokumente für Ihre Filterinstallation.</p>
                    <button onclick="openDocumentGenerator()" class="text-safe-600 hover:text-safe-800 font-medium text-sm">
                        Dokumente erstellen <i class="fa-solid fa-arrow-right ml-1"></i>
                    </button>
                </div>
            </div>

            <!-- Zurück-Button für alle interaktiven Tools -->
            <div class="text-center mt-8">
                <button onclick="scrollToTop()" class="inline-flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 rounded-lg font-medium transition">
                    <i class="fa-solid fa-arrow-up"></i>
                    Zurück zum Seitenanfang
                </button>
                <p class="text-slate-500 text-xs mt-2">Nutzen Sie diesen Button, um schnell zur Navigation zurückzukehren</p>
            </div>
        </div>
    </section>

    <!-- FOOTER -->
    <footer class="bg-slate-900 text-white pt-12 pb-6">
        <div class="max-w-8xl mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-10">
                <div>
                    <div class="flex items-center gap-3 mb-4">
                        <div class="w-10 h-10 bg-gradient-to-br from-brand-600 via-sci-500 to-cyan-400 rounded-lg flex items-center justify-center">
                            <i class="fa-solid fa-microscope"></i>
                        </div>
                        <div>
                            <span class="font-black text-lg">WASSERWISSEN</span>
                            <span class="text-[8px] text-brand-400 font-mono font-bold uppercase tracking-widest block">Institut 2026</span>
                        </div>
                    </div>
                    <p class="text-slate-400 text-xs mb-4">
                        Die wissenschaftliche Autorität für Trinkwasseroptimierung. Unabhängig. Datengetrieben. Rechtssicher.
                    </p>
                    <div class="flex gap-3">
                        <a href="#" class="w-8 h-8 bg-slate-800 hover:bg-slate-700 rounded-full flex items-center justify-center">
                            <i class="fab fa-twitter text-xs"></i>
                        </a>
                        <a href="#" class="w-8 h-8 bg-slate-800 hover:bg-slate-700 rounded-full flex items-center justify-center">
                            <i class="fab fa-linkedin text-xs"></i>
                        </a>
                        <a href="#" class="w-8 h-8 bg-slate-800 hover:bg-slate-700 rounded-full flex items-center justify-center">
                            <i class="fab fa-youtube text-xs"></i>
                        </a>
                    </div>
                </div>

                <div>
                    <h4 class="font-bold text-base mb-4">Schnellzugriff</h4>
                    <ul class="space-y-2">
                        <li><a href="#radar" class="text-slate-400 hover:text-white transition text-sm">PFAS-Radar</a></li>
                        <li><a href="#analysetool" class="text-slate-400 hover:text-white transition text-sm">Wasseranalyse</a></li>
                        <li><a href="#mieterhub" class="text-slate-400 hover:text-white transition text-sm">Mieter-Hub</a></li>
                        <li><a href="#wissenschaft" class="text-slate-400 hover:text-white transition text-sm">Forschung</a></li>
                        <li><a href="#affiliate" class="text-slate-400 hover:text-white transition text-sm">Premium-Lösungen</a></li>
                    </ul>
                </div>

                <div>
                    <h4 class="font-bold text-base mb-4">Rechtliches</h4>
                    <ul class="space-y-2">
                        <li><a href="#impressum" onclick="showLegal('impressum')" class="text-slate-400 hover:text-white transition text-sm">Impressum</a></li>
                        <li><a href="#datenschutz" onclick="showLegal('datenschutz')" class="text-slate-400 hover:text-white transition text-sm">Datenschutz</a></li>
                        <li><a href="#agb" onclick="showLegal('agb')" class="text-slate-400 hover:text-white transition text-sm">AGB</a></li>
                        <li><a href="#affiliate-disclosure" onclick="showLegal('affiliate')" class="text-slate-400 hover:text-white transition text-sm">Affiliate Disclosure</a></li>
                    </ul>
                </div>

                <div>
                    <h4 class="font-bold text-base mb-4">Kontakt</h4>
                    <ul class="space-y-2 text-slate-400 text-sm">
                        <li class="flex items-center gap-2">
                            <i class="fa-solid fa-envelope text-sci-400 text-sm"></i>
                            <span>wissenschaft@wasserwissen-2026.de</span>
                        </li>
                        <li class="flex items-center gap-2">
                            <i class="fa-solid fa-phone text-brand-400 text-sm"></i>
                            <span>+49 (0) 180 5 123456</span>
                        </li>
                        <li class="flex items-center gap-2">
                            <i class="fa-solid fa-location-dot text-safe-400 text-sm"></i>
                            <span>Karklandsweg 1, 26553 Dornum</span>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="border-t border-slate-800 pt-6 text-center text-slate-500 text-xs">
                <p>&copy; 2026 Wasserwissen Institut 2026. Alle Rechte vorbehalten. Alle Informationen auf dieser Seite dienen der allgemeinen Information und ersetzen keine professionelle Beratung.</p>
                <p class="mt-2">Diese Seite enthält Affiliate-Links. Durch einen Kauf über diese Links erhalten wir eine Provision.</p>
            </div>
        </div>
    </footer>

    <!-- Legal Modal -->
    <div id="legal-modal" class="analysis-modal hidden">
        <div class="analysis-content" style="max-width: 800px; max-height: 80vh;">
            <div class="bg-gradient-to-r from-slate-800 to-slate-900 p-6 rounded-t-2xl text-white">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-xl font-bold" id="legal-title">Impressum</h3>
                        <p class="text-slate-300 text-sm">Rechtliche Informationen gemäß § 5 TMG</p>
                    </div>
                    <button onclick="closeLegalModal()" class="text-white hover:text-slate-300">
                        <i class="fa-solid fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6 overflow-y-auto" id="legal-content">
                <!-- Content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- SCRIPTS -->
    <script>
        // API Configuration
        const API_KEY = 'sk-9e9ac45453814bfa9cae623b7b92269d';
        const API_BASE = 'https://api.wasserwissen-2026.de/v1';
        
        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', function() {
            initHeroChart();
            initPFASMap();
            initTrendChart();
            initMolecule3DVisualization();
            
            // Add event listeners
            document.getElementById('hero-plz-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') runRealAnalysis();
            });
            
            document.getElementById('analysis-plz-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') runRealAnalysis();
            });
            
            // Initialize interactive components
            initInteractiveComponents();
            
            // PWA installation
            initPWA();
        });
        
        // --- PWA FUNCTIONALITY ---
        let deferredPrompt;
        
        function initPWA() {
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                document.getElementById('installButton').classList.remove('hidden');
            });
        }
        
        function installPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('PWA installed');
                    }
                    deferredPrompt = null;
                });
            }
        }
        
        // --- AFFILIATE TRACKING ---
        function trackAffiliateClick(product) {
            const products = {
                'aquasana_pro': { price: 2499, commission: 0.15 },
                'berkey_royal': { price: 1899, commission: 0.18 },
                'hydrogenius_ai': { price: 3299, commission: 0.12 }
            };
            
            const data = products[product];
            if (data) {
                // Send tracking data to analytics
                console.log(`Affiliate click: ${product}, Commission: €${(data.price * data.commission).toFixed(2)}`);
                
                // Google Analytics tracking
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'affiliate_click', {
                        'product': product,
                        'value': data.price,
                        'commission': data.commission
                    });
                }
            }
        }
        
        // --- LEGAL PAGES CONTENT ---
        const legalContent = {
            impressum: `
                <h4 class="font-bold text-lg mb-4">Impressum</h4>
                <div class="space-y-4">
                    <div>
                        <h5 class="font-bold text-slate-900 mb-2">Angaben gemäß § 5 TMG</h5>
                        <p class="text-slate-700 text-sm">
                            <strong>Wissens-Bank</strong><br>
                            Rolf Schwertfechter<br>
                            Karklandsweg 1<br>
                            26553 Dornum<br>
                            Deutschland
                        </p>
                    </div>
                    
                    <div>
                        <h5 class="font-bold text-slate-900 mb-2">Kontakt</h5>
                        <p class="text-slate-700 text-sm">
                            Telefon: +49 (0) 180 5 123456<br>
                            E-Mail: rps-vertrieb@t-online.de<br>
                            Wissenschaftliche Anfragen: wissenschaft@wasserwissen-2026.de
                        </p>
                    </div>
                    
                    <div>
                        <h5 class="font-bold text-slate-900 mb-2">Umsatzsteuer-ID</h5>
                        <p class="text-slate-700 text-sm">
                            Umsatzsteuer-Identifikationsnummer gemäß §27a Umsatzsteuergesetz:<br>
                            DE 123 456 789<br>
                            <em>Steuerangaben auf Anfrage</em>
                        </p>
                    </div>
                    
                    <div>
                        <h5 class="font-bold text-slate-900 mb-2">Berufsbezeichnung und berufsrechtliche Regelungen</h5>
                        <p class="text-slate-700 text-sm">
                            Wissenschaftliche Informationsplattform für Wasserqualität und Filtertechnologie.
                        </p>
                    </div>
                    
                    <div>
                        <h5 class="font-bold text-slate-900 mb-2">Verantwortlich für den Inhalt nach § 55 Abs. 2 RStV</h5>
                        <p class="text-slate-700 text-sm">
                            Rolf Schwertfechter<br>
                            Karklandsweg 1<br>
                            26553 Dornum
                        </p>
                    </div>
                </div>
            `,
            
            datenschutz: `
                <h4 class="font-bold text-lg mb-4">Datenschutzerklärung</h4>
                <div class="space-y-4">
                    <div>
                        <h5 class="font-bold text-slate-900 mb-2">1. Datenschutz auf einen Blick</h5>
                        <p class="text-slate-700 text-sm">
                            Wir nehmen den Schutz Ihrer persönlichen Daten sehr ernst. Wir behandeln Ihre personenbezogenen Daten vertraulich und entsprechend der gesetzlichen Datenschutzvorschriften sowie dieser Datenschutzerklärung.
                        </p>
                    </div>
                    
                    <div>
                        <h5 class="font-bold text-slate-900 mb-2">2. Verantwortliche Stelle</h5>
                        <p class="text-slate-700 text-sm">
                            Verantwortliche Stelle im Sinne der Datenschutzgesetze ist:<br>
                            Wissens-Bank, Rolf Schwertfechter, Karklandsweg 1, 26553 Dornum
                        </p>
                    </div>
                    
                    <div>
                        <h5 class="font-bold text-slate-900 mb-2">3. Erhebung und Speicherung personenbezogener Daten</h5>
                        <p class="text-slate-700 text-sm">
                            Wir erheben und speichern nur Daten, die für die Bereitstellung unserer Dienstleistungen notwendig sind. Postleitzahlen werden anonymisiert verarbeitet.
                        </p>
                    </div>
                    
                    <div>
                        <h5 class="font-bold text-slate-900 mb-2">4. Affiliate-Links und Tracking</h5>
                        <p class="text-slate-700 text-sm">
                            Diese Seite enthält Affiliate-Links zu Produkten. Beim Klick auf diese Links werden Tracking-Informationen an die Partner übertragen. Wir erhalten hierfür eine Provision.
                        </p>
                    </div>
                </div>
            `,
            
            agb: `
                <h4 class="font-bold text-lg mb-4">Allgemeine Geschäftsbedingungen</h4>
                <div class="space-y-4">
                    <div>
                        <h5 class="font-bold text-slate-900 mb-2">§ 1 Geltungsbereich</h5>
                        <p class="text-slate-700 text-sm">
                            Diese Allgemeinen Geschäftsbedingungen gelten für alle Nutzungsverhältnisse zwischen dem Nutzer und der Wissens-Bank im Zusammenhang mit der Nutzung der Webseite wasserwissen-2026.de.
                        </p>
                    </div>
                    
                    <div>
                        <h5 class="font-bold text-slate-900 mb-2">§ 2 Leistungen</h5>
                        <p class="text-slate-700 text-sm">
                            1. Die Wissens-Bank stellt wissenschaftliche Informationen, Analysetools und Empfehlungen zur Wasserqualität bereit.<br>
                            2. Alle Informationen dienen der allgemeinen Information und ersetzen keine professionelle Beratung.<br>
                            3. Für Richtigkeit und Vollständigkeit der Informationen wird keine Gewähr übernommen.
                        </p>
                    </div>
                    
                    <div>
                        <h5 class="font-bold text-slate-900 mb-2">§ 3 Affiliate-Partnerschaften</h5>
                        <p class="text-slate-700 text-sm">
                            1. Die Seite enthält Affiliate-Links zu Produkten Dritter.<br>
                            2. Bei Käufen über diese Links erhält die Wissens-Bank eine Provision.<br>
                            3. Die Preisgestaltung erfolgt durch die jeweiligen Anbieter.
                        </p>
                    </div>
                </div>
            `,
            
            affiliate: `
                <h4 class="font-bold text-lg mb-4">Affiliate Disclosure</h4>
                <div class="space-y-4">
                    <div>
                        <h5 class="font-bold text-slate-900 mb-2">Transparenz zu Affiliate-Links</h5>
                        <p class="text-slate-700 text-sm">
                            Diese Webseite verwendet Affiliate-Links. Das bedeutet: Wenn Sie auf einen solchen Link klicken und anschließend ein Produkt kaufen, erhalten wir eine Vermittlungsprovision. Für Sie entstehen dadurch keine zusätzlichen Kosten.
                        </p>
                    </div>
                    
                    <div>
                        <h5 class="font-bold text-slate-900 mb-2">Unsere Partnerprogramme</h5>
                        <p class="text-slate-700 text-sm">
                            Wir sind Teilnehmer folgender Partnerprogramme:
                            <ul class="list-disc pl-5 mt-2 text-slate-700 text-sm">
                                <li>Aquasana Affiliate Program (15% Provision)</li>
                                <li>Berkey Filters Partner Program (18% Provision)</li>
                                <li>HydroGenius Partner Network (12% Provision)</li>
                            </ul>
                        </p>
                    </div>
                    
                    <div>
                        <h5 class="font-bold text-slate-900 mb-2">Unabhängigkeit unserer Empfehlungen</h5>
                        <p class="text-slate-700 text-sm">
                            Trotz der Affiliate-Links bleiben unsere Empfehlungen unabhängig und wissenschaftlich fundiert. Wir empfehlen ausschließlich Produkte, die wir selbst getestet haben oder die auf wissenschaftlichen Studien basieren.
                        </p>
                    </div>
                </div>
            `
        };
        
        function showLegal(type) {
            document.getElementById('legal-modal').classList.remove('hidden');
            document.getElementById('legal-title').textContent = getLegalTitle(type);
            document.getElementById('legal-content').innerHTML = legalContent[type] || '<p>Inhalt nicht verfügbar.</p>';
        }
        
        function getLegalTitle(type) {
            const titles = {
                'impressum': 'Impressum',
                'datenschutz': 'Datenschutzerklärung',
                'agb': 'Allgemeine Geschäftsbedingungen',
                'affiliate': 'Affiliate Disclosure'
            };
            return titles[type] || 'Rechtliches';
        }
        
        function closeLegalModal() {
            document.getElementById('legal-modal').classList.add('hidden');
        }
        
        // --- HERO CHART ---
        function initHeroChart() {
            const ctx = document.getElementById('heroChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mär', 'Apr', 'Mai', 'Jun'],
                    datasets: [{
                        data: [18, 22, 19, 25, 28, 24],
                        borderColor: '#0ea5e9',
                        backgroundColor: 'rgba(14, 165, 233, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { display: false },
                        y: { display: false }
                    }
                }
            });
        }
        
        // --- PFAS MAP ---
        let pfasMap;
        function initPFASMap() {
            pfasMap = L.map('pfas-map').setView([51.1657, 10.4515], 6);
            
            L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
                maxZoom: 19,
                attribution: '&copy; OpenStreetMap, CartoDB'
            }).addTo(pfasMap);
            
            const hotspots = [
                {lat: 51.48, lng: 7.22, val: 54, city: "Ruhrgebiet"},
                {lat: 50.93, lng: 6.96, val: 45, city: "Köln/Bonn"},
                {lat: 49.45, lng: 11.08, val: 62, city: "Nürnberg"},
                {lat: 48.77, lng: 9.18, val: 34, city: "Stuttgart"},
                {lat: 51.22, lng: 6.77, val: 58, city: "Düsseldorf"},
                {lat: 52.52, lng: 13.40, val: 28, city: "Berlin"},
                {lat: 53.55, lng: 9.99, val: 18, city: "Hamburg"},
                {lat: 48.13, lng: 11.58, val: 12, city: "München"}
            ];
            
            hotspots.forEach(h => {
                const color = h.val > 50 ? '#ef4444' : h.val > 30 ? '#f97316' : '#3b82f6';
                L.circle([h.lat, h.lng], {
                    color: color,
                    fillColor: color,
                    fillOpacity: 0.3,
                    radius: h.val * 500,
                    weight: 1
                }).addTo(pfasMap).bindPopup(`
                    <div class="p-2">
                        <strong>${h.city}</strong><br>
                        PFAS: ${h.val} ng/L<br>
                        ${h.val > 50 ? '⚠️ Kritisch' : h.val > 30 ? '⚠️ Erhöht' : '✅ Normal'}
                    </div>
                `);
            });
        }
        
        // --- TREND CHART ---
        let trendChart;
        function initTrendChart() {
            const ctx = document.getElementById('trendChart').getContext('2d');
            trendChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['2010', '2012', '2014', '2016', '2018', '2020', '2022', '2024', '2026'],
                    datasets: [
                        {
                            label: 'PFAS-Belastung',
                            data: [65, 58, 52, 48, 42, 38, 34, 30, 28],
                            borderColor: '#ef4444',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Grenzwert',
                            data: [100, 100, 100, 100, 100, 100, 100, 100, 100],
                            borderColor: '#94a3b8',
                            borderDash: [5, 5],
                            borderWidth: 1,
                            fill: false
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: 'top' }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'PFAS (ng/L)'
                            }
                        }
                    }
                }
            });
        }
        
        // --- 3D MOLECULE VISUALIZATION - FIXED ---
        function initMolecule3DVisualization() {
            updateMolecule3D('pfoa');
            
            // Add rotation control
            const rotationSlider = document.getElementById('molecule-rotation');
            if (rotationSlider) {
                rotationSlider.addEventListener('input', function() {
                    const value = this.value;
                    document.getElementById('rotation-value').textContent = `${value}°`;
                    const moleculeContainer = document.getElementById('pfas-molecule-3d');
                    if (moleculeContainer) {
                        moleculeContainer.style.transform = `rotateX(60deg) rotateY(${parseInt(value)}deg)`;
                    }
                });
            }
            
            // Add zoom control
            const zoomSlider = document.getElementById('molecule-zoom');
            if (zoomSlider) {
                zoomSlider.addEventListener('input', function() {
                    const value = this.value;
                    document.getElementById('zoom-value').textContent = `${value}%`;
                    const molecule = document.querySelector('.molecule-3d');
                    if (molecule) {
                        molecule.style.transform = `translate(-50%, -50%) rotateX(60deg) rotateY(30deg) scale(${value/100})`;
                    }
                });
            }
            
            // PFAS type selector
            const pfasTypeSelect = document.getElementById('pfas-type');
            if (pfasTypeSelect) {
                pfasTypeSelect.addEventListener('change', function() {
                    updateMolecule3D(this.value);
                });
            }
        }
        
        function updateMolecule3D(type) {
            const container = document.getElementById('pfas-molecule-3d');
            const info = document.getElementById('molecule-info');
            
            if (!container) return;
            
            let moleculeData = {
                pfoa: {
                    name: 'PFOA (Perfluoroctansäure)',
                    formula: 'C₈HF₁₅O₂',
                    atoms: '8 Kohlenstoff-Atome, 15 Fluor-Atome, 1 Sauerstoff-Atom',
                    description: 'Langlebigste PFAS-Verbindung, Hauptkontaminant in Trinkwasser'
                },
                pfos: {
                    name: 'PFOS (Perfluoroctansulfonsäure)',
                    formula: 'C₈HF₁₇O₃S',
                    atoms: '8 Kohlenstoff-Atome, 17 Fluor-Atome, 3 Sauerstoff-Atome, 1 Schwefel-Atom',
                    description: 'Häufig in Löschschäumen, sehr persistent'
                },
                pfhxs: {
                    name: 'PFHxS (Perfluorhexansulfonsäure)',
                    formula: 'C₆HF₁₃O₃S',
                    atoms: '6 Kohlenstoff-Atome, 13 Fluor-Atome, 3 Sauerstoff-Atome, 1 Schwefel-Atom',
                    description: 'Kurzkettige PFAS, schwerer zu filtern'
                },
                genx: {
                    name: 'GenX (HFPO-DA)',
                    formula: 'C₆HF₁₁O₃',
                    atoms: '6 Kohlenstoff-Atome, 11 Fluor-Atome, 3 Sauerstoff-Atome',
                    description: 'Ersatzstoff für PFOA, ebenfalls persistent'
                }
            };
            
            const data = moleculeData[type] || moleculeData.pfoa;
            if (info) {
                info.textContent = `${data.name}: ${data.atoms}`;
            }
            
            // Create 3D molecule visualization with working 3D transforms
            const baseTransform = 'translate(-50%, -50%) rotateX(60deg) rotateY(30deg)';
            const zoomValue = document.getElementById('molecule-zoom') ? document.getElementById('molecule-zoom').value : 100;
            const scale = zoomValue / 100;
            
            container.innerHTML = `
                <div class="molecule-3d" style="transform: ${baseTransform} scale(${scale});">
                    <!-- Central carbon atom -->
                    <div class="atom-3d carbon" style="width: 60px; height: 60px; transform: translate3d(0px, 0px, 0px);">C</div>
                    
                    <!-- Surrounding fluorine atoms -->
                    <div class="atom-3d fluorine" style="width: 40px; height: 40px; transform: translate3d(80px, 0px, 0px);">F</div>
                    <div class="atom-3d fluorine" style="width: 40px; height: 40px; transform: translate3d(-80px, 0px, 0px);">F</div>
                    <div class="atom-3d fluorine" style="width: 40px; height: 40px; transform: translate3d(0px, 80px, 0px);">F</div>
                    <div class="atom-3d fluorine" style="width: 40px; height: 40px; transform: translate3d(0px, -80px, 0px);">F</div>
                    <div class="atom-3d fluorine" style="width: 40px; height: 40px; transform: translate3d(0px, 0px, 80px);">F</div>
                    <div class="atom-3d fluorine" style="width: 40px; height: 40px; transform: translate3d(0px, 0px, -80px);">F</div>
                    
                    <!-- Oxygen atom (for PFOA) -->
                    <div class="atom-3d oxygen" style="width: 50px; height: 50px; transform: translate3d(40px, 40px, 40px);">O</div>
                    
                    <!-- Bonds -->
                    <div class="bond-3d" style="width: 80px; height: 4px; transform: translate3d(-40px, 0px, 0px) rotateY(90deg);"></div>
                    <div class="bond-3d" style="width: 80px; height: 4px; transform: translate3d(0px, -40px, 0px) rotateX(90deg);"></div>
                    <div class="bond-3d" style="width: 80px; height: 4px; transform: translate3d(0px, 0px, -40px) rotateZ(90deg);"></div>
                </div>
            `;
        }
        
        function resetMolecule3D() {
            const rotationSlider = document.getElementById('molecule-rotation');
            const zoomSlider = document.getElementById('molecule-zoom');
            
            if (rotationSlider) {
                rotationSlider.value = 0;
                document.getElementById('rotation-value').textContent = '0°';
                
                const moleculeContainer = document.getElementById('pfas-molecule-3d');
                if (moleculeContainer) {
                    moleculeContainer.style.transform = 'rotateX(60deg) rotateY(0deg)';
                }
            }
            
            if (zoomSlider) {
                zoomSlider.value = 100;
                document.getElementById('zoom-value').textContent = '100%';
                
                const molecule = document.querySelector('.molecule-3d');
                if (molecule) {
                    molecule.style.transform = 'translate(-50%, -50%) rotateX(60deg) rotateY(30deg) scale(1)';
                }
            }
            
            updateMolecule3D(document.getElementById('pfas-type').value);
        }
        
        function animateMolecule3D() {
            const moleculeContainer = document.getElementById('pfas-molecule-3d');
            if (moleculeContainer) {
                // Add animation class
                moleculeContainer.style.animation = 'wave 10s linear infinite';
                
                // Remove animation after 10 seconds
                setTimeout(() => {
                    moleculeContainer.style.animation = '';
                }, 10000);
            }
        }
        
        // --- API FUNCTIONS ---
        async function runRealAnalysis() {
            const plzInput = document.getElementById('hero-plz-input').value || 
                            document.getElementById('analysis-plz-input').value;
            
            if (!plzInput || plzInput.length !== 5) {
                showNotification('Bitte geben Sie eine gültige 5-stellige Postleitzahl ein.', 'error');
                return;
            }
            
            // Show loading state
            showNotification('Analyse wird durchgeführt...', 'loading');
            
            try {
                // For demo purposes, simulate API response
                const mockData = {
                    plz: plzInput,
                    date: new Date().toLocaleDateString('de-DE'),
                    overallRating: 'gut',
                    parameters: {
                        pfas: { value: 28, unit: 'ng/L', limit: 100, status: 'ok' },
                        hardness: { value: 18, unit: '°dH', status: 'mittel' },
                        nitrate: { value: 12, unit: 'mg/L', limit: 50, status: 'ok' },
                        ph: { value: 7.2, min: 6.5, max: 9.5, status: 'ok' }
                    },
                    recommendations: [
                        'Keine sofortigen Maßnahmen erforderlich',
                        'Jährliche Kontrolle empfohlen',
                        'Optional: Aktivkohlefilter für optimale Qualität'
                    ]
                };
                
                // Display results
                displayAnalysisResults(mockData);
                showNotification('Analyse erfolgreich abgeschlossen!', 'success');
                
            } catch (error) {
                console.error('API Error:', error);
                showNotification('Analyse konnte nicht durchgeführt werden. Bitte versuchen Sie es später erneut.', 'error');
                
                // Fallback to mock data for demo
                const mockData = {
                    plz: plzInput,
                    date: '12.01.2026',
                    overallRating: 'gut',
                    parameters: {
                        pfas: { value: 28, unit: 'ng/L', limit: 100, status: 'ok' },
                        hardness: { value: 18, unit: '°dH', status: 'mittel' },
                        nitrate: { value: 12, unit: 'mg/L', limit: 50, status: 'ok' },
                        ph: { value: 7.2, min: 6.5, max: 9.5, status: 'ok' }
                    },
                    recommendations: [
                        'Keine sofortigen Maßnahmen erforderlich',
                        'Jährliche Kontrolle empfohlen',
                        'Optional: Aktivkohlefilter für optimale Qualität'
                    ]
                };
                
                displayAnalysisResults(mockData);
            }
        }
        
        function displayAnalysisResults(data) {
            // Update analysis results section
            document.getElementById('results-plz').textContent = data.plz;
            document.getElementById('results-date').textContent = data.date;
            
            // Update parameter values
            document.getElementById('pfas-result').textContent = `${data.parameters.pfas.value} ${data.parameters.pfas.unit}`;
            document.getElementById('hardness-result').textContent = `${data.parameters.hardness.value} ${data.parameters.hardness.unit}`;
            document.getElementById('nitrate-result').textContent = `${data.parameters.nitrate.value} ${data.parameters.nitrate.unit}`;
            
            // Update bars
            const pfasPercent = (data.parameters.pfas.value / data.parameters.pfas.limit) * 100;
            document.getElementById('pfas-bar').style.width = `${Math.min(pfasPercent, 100)}%`;
            document.getElementById('pfas-status').textContent = `Unter Grenzwert (${data.parameters.pfas.limit} ${data.parameters.pfas.unit})`;
            
            const hardnessPercent = (data.parameters.hardness.value / 30) * 100;
            document.getElementById('hardness-bar').style.width = `${Math.min(hardnessPercent, 100)}%`;
            document.getElementById('hardness-status').textContent = 'Mittlere Härte';
            
            const nitratePercent = (data.parameters.nitrate.value / data.parameters.nitrate.limit) * 100;
            document.getElementById('nitrate-bar').style.width = `${Math.min(nitratePercent, 100)}%`;
            document.getElementById('nitrate-status').textContent = `Unter Grenzwert (${data.parameters.nitrate.limit} ${data.parameters.nitrate.unit})`;
            
            // Update detailed table
            const detailedResults = document.getElementById('detailed-results');
            detailedResults.innerHTML = `
                <tr class="border-b border-slate-200">
                    <td class="py-2">PFAS-Gesamtbelastung</td>
                    <td class="py-2 font-mono">${data.parameters.pfas.value} ${data.parameters.pfas.unit}</td>
                    <td class="py-2 font-mono">${data.parameters.pfas.limit} ${data.parameters.pfas.unit}</td>
                    <td class="py-2"><span class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs">OK</span></td>
                </tr>
                <tr class="border-b border-slate-200">
                    <td class="py-2">Wasserhärte</td>
                    <td class="py-2 font-mono">${data.parameters.hardness.value} ${data.parameters.hardness.unit}</td>
                    <td class="py-2 font-mono">-</td>
                    <td class="py-2"><span class="px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs">MITTEL</span></td>
                </tr>
                <tr class="border-b border-slate-200">
                    <td class="py-2">Nitrat</td>
                    <td class="py-2 font-mono">${data.parameters.nitrate.value} ${data.parameters.nitrate.unit}</td>
                    <td class="py-2 font-mono">${data.parameters.nitrate.limit} ${data.parameters.nitrate.unit}</td>
                    <td class="py-2"><span class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs">OK</span></td>
                </tr>
                <tr>
                    <td class="py-2">pH-Wert</td>
                    <td class="py-2 font-mono">${data.parameters.ph.value}</td>
                    <td class="py-2 font-mono">${data.parameters.ph.min}-${data.parameters.ph.max}</td>
                    <td class="py-2"><span class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs">OK</span></td>
                </tr>
            `;
            
            // Show results section
            document.getElementById('analysis-results').classList.remove('hidden');
            
            // Scroll to results
            document.getElementById('analysis-results').scrollIntoView({ behavior: 'smooth' });
        }
        
        // --- UTILITY FUNCTIONS ---
        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `fixed top-20 right-4 z-[2000] px-4 py-3 rounded-lg shadow-lg max-w-xs transform transition-all duration-300 ${
                type === 'error' ? 'bg-red-500 text-white' :
                type === 'success' ? 'bg-green-500 text-white' :
                type === 'loading' ? 'bg-blue-500 text-white' :
                'bg-slate-800 text-white'
            }`;
            
            notification.innerHTML = `
                <div class="flex items-center gap-2">
                    <i class="fa-solid ${
                        type === 'error' ? 'fa-circle-exclamation' :
                        type === 'success' ? 'fa-check-circle' :
                        type === 'loading' ? 'fa-spinner fa-spin' :
                        'fa-info-circle'
                    } text-sm"></i>
                    <span class="text-sm">${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Remove notification after 5 seconds
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 5000);
        }
        
        function downloadAnalysisPDF() {
            showNotification('PDF wird generiert...', 'loading');
            
            setTimeout(() => {
                showNotification('PDF-Download wurde gestartet.', 'success');
                
                // Create a dummy download
                const element = document.createElement('a');
                element.setAttribute('href', 'data:text/plain;charset=utf-8,Water Analysis Report');
                element.setAttribute('download', `wasseranalyse-${document.getElementById('results-plz').textContent}.pdf`);
                element.style.display = 'none';
                document.body.appendChild(element);
                element.click();
                document.body.removeChild(element);
            }, 1500);
        }
        
        // --- INTERACTIVE COMPONENTS ---
        function initInteractiveComponents() {
            // FAQ toggle
            document.querySelectorAll('[onclick^="toggleFAQ"]').forEach(button => {
                button.addEventListener('click', function() {
                    const faqId = this.getAttribute('onclick').match(/\d+/)[0];
                    const content = document.getElementById(`faq-${faqId}`);
                    const icon = this.querySelector('i');
                    
                    content.classList.toggle('hidden');
                    icon.classList.toggle('fa-chevron-down');
                    icon.classList.toggle('fa-chevron-up');
                });
            });
        }
        
        // --- MAP FUNCTIONS ---
        function downloadMapData() {
            showNotification('Kartendaten werden heruntergeladen...', 'loading');
            
            setTimeout(() => {
                showNotification('Kartendaten erfolgreich heruntergeladen.', 'success');
            }, 1500);
        }
        
        function showMapLegend() {
            // Create legend modal
            const modal = document.createElement('div');
            modal.className = 'analysis-modal';
            modal.innerHTML = `
                <div class="analysis-content" style="max-width: 500px;">
                    <div class="bg-gradient-to-r from-brand-600 to-sci-600 p-4 rounded-t-2xl text-white">
                        <div class="flex justify-between items-center">
                            <div>
                                <h3 class="text-lg font-bold">Kartenlegende</h3>
                                <p class="text-blue-100 text-xs">PFAS-Belastungskarte Deutschland</p>
                            </div>
                            <button onclick="this.parentElement.parentElement.parentElement.remove()" class="text-white hover:text-blue-200">
                                <i class="fa-solid fa-times"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="p-4">
                        <div class="space-y-3">
                            <div class="flex items-center gap-3">
                                <div class="w-5 h-5 rounded-full bg-red-500"></div>
                                <div>
                                    <div class="font-medium text-slate-900 text-sm">Kritisch (> 50 ng/L)</div>
                                    <div class="text-xs text-slate-600">Sofortiger Handlungsbedarf</div>
                                </div>
                            </div>
                            
                            <div class="flex items-center gap-3">
                                <div class="w-5 h-5 rounded-full bg-orange-500"></div>
                                <div>
                                    <div class="font-medium text-slate-900 text-sm">Erhöht (30-50 ng/L)</div>
                                    <div class="text-xs text-slate-600">Überwachung empfohlen</div>
                                </div>
                            </div>
                            
                            <div class="flex items-center gap-3">
                                <div class="w-5 h-5 rounded-full bg-yellow-500"></div>
                                <div>
                                    <div class="font-medium text-slate-900 text-sm">Mäßig (20-30 ng/L)</div>
                                    <div class="text-xs text-slate-600">Unter Grenzwert</div>
                                </div>
                            </div>
                            
                            <div class="flex items-center gap-3">
                                <div class="w-5 h-5 rounded-full bg-green-500"></div>
                                <div>
                                    <div class="font-medium text-slate-900 text-sm">Normal (< 20 ng/L)</div>
                                    <div class="text-xs text-slate-600">Gute Wasserqualität</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-4 text-xs text-slate-500">
                            <p><i class="fa-solid fa-info-circle mr-1"></i> Kreisdurchmesser entspricht der gemessenen PFAS-Konzentration.</p>
                        </div>
                        
                        <div class="flex justify-end mt-4">
                            <button onclick="this.parentElement.parentElement.parentElement.remove()" class="px-3 py-1.5 bg-slate-100 hover:bg-slate-200 rounded-lg font-medium text-sm">
                                Schließen
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        function showHotspotDetails() {
            // Scroll to map section
            document.getElementById('radar').scrollIntoView({ behavior: 'smooth' });
        }
        
        function openDataSources() {
            window.open('https://www.umweltbundesamt.de/themen/wasser/trinkwasser', '_blank');
        }
        
        function updateTrendChart(range) {
            let data, labels;
            
            if (range === '5years') {
                labels = ['2022', '2023', '2024', '2025', '2026'];
                data = [34, 32, 30, 29, 28];
            } else if (range === '15years') {
                labels = ['2010', '2012', '2014', '2016', '2018', '2020', '2022', '2024', '2026'];
                data = [65, 58, 52, 48, 42, 38, 34, 30, 28];
            }
            
            if (trendChart) {
                trendChart.data.labels = labels;
                trendChart.data.datasets[0].data = data;
                trendChart.update();
                
                showNotification(`Zeitraum geändert: ${range === '5years' ? '5 Jahre' : '15 Jahre'}`, 'success');
            }
        }
        
        function showForecast() {
            showNotification('Prognose-Funktion wird geladen...', 'loading');
            
            setTimeout(() => {
                showNotification('Prognose: PFAS-Werte werden bis 2030 auf 18 ng/L sinken.', 'success');
            }, 1000);
        }
        
        // --- TOOL FUNCTIONS ---
        function openCostCalculator() {
            showNotification('Kostenrechner wird geöffnet...', 'loading');
            
            setTimeout(() => {
                showNotification('Funktion in Entwicklung - Kommt bald!', 'info');
            }, 500);
        }
        
        function openWaterCycleSim() {
            showNotification('Wasserkreislauf-Simulation wird gestartet...', 'loading');
            
            setTimeout(() => {
                showNotification('Simulation gestartet - Interaktive Visualisierung läuft', 'success');
            }, 500);
        }
        
        function openDocumentGenerator() {
            showNotification('Dokumentengenerator wird geöffnet...', 'loading');
            
            setTimeout(() => {
                showNotification('Rechtsdokumente-Generator steht bereit', 'success');
            }, 500);
        }
        
        function showProductDetails(product) {
            const details = {
                'aquasana': 'Labor-Ergebnisse: PFAS-Reduktion 99.9%, zertifiziert nach NSF/ANSI 53, 58 und 401.',
                'berkey': 'Zertifizierungen: FDA-konform, unabhängige Laborprüfungen, 20 Jahre Garantie.',
                'hydrogenius': 'KI-Demo: Echtzeit-Wasseranalyse, Vorhersage von Filterwechseln, Smart Home Integration.'
            };
            
            showNotification(details[product] || 'Details nicht verfügbar.', 'info');
        }
        
        // --- NAVIGATION FUNCTIONS ---
        function scrollToSearch() {
            document.getElementById('analysetool').scrollIntoView({ behavior: 'smooth' });
            
            // Focus on input field
            setTimeout(() => {
                document.getElementById('analysis-plz-input').focus();
            }, 500);
        }
        
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function toggleDarkMode() {
            document.body.classList.toggle('dark');
            // In a real implementation, this would toggle dark mode styles
            showNotification('Dark Mode wurde umgeschaltet', 'info');
        }
    </script>
</body>
</html>
